{% extends "teacher/base.html" %}
{% block title %}View Course{% endblock %}
{% block content %}
<h1>Coursework Details for {{ coursework.name }}:</h1>
    <form method="POST" action="" enctype="multipart/form-data">
    {% csrf_token %}
    <label for="id_name">Coursework Name:</label><input id="id_name" maxlength="128" name="name" type="text" required="">
<label for="id_state">Coursework State:</label><select id="id_state" name="state" required="">
<option value="i">Invisible to Students</option>
<option value="c">Closed for Submissions</option>
<option value="u">Accepting Uploads</option>
<option value="f">Accepting Feedback</option>
</select>
<label for="id_descriptor">Files for Coursework descriptor:</label><input id="id_descriptor" multiple="multiple" name="descriptor" type="file" required="">
<label for="id_oracle_exec">Files for Oracle implementation:</label><input id="id_oracle_exec" multiple="multiple" name="oracle_exec" type="file" required="">
<label for="id_identity">Files for Identity test:</label><input id="id_identity" multiple="multiple" name="identity" type="file" required="">
    <input type="submit" value="Save">
</form>
<p></p>
    <h1>Coursework Files</h1>
    <table>
    <thead>
    <tr>
        <th>SUBID</th>
        <th>Filepath</th>
        <th>Creator</th>
        <th>Type</th>
        <th>View</th>
    </tr>
    </thead>
    {% for s, files in results %}
    {% for f in files %}
        <tr>
        <td>{{ f.id }}</td>
        <td>{{ f.file }}</td>
        <td>{{ s.creator }}</td>
        <td>{{ s.type }}</td>
        <td><a href="{% url 'render_file' s.id f.id %}">Html</a> <a href="{% url 'show_file' s.id f.id %}">Raw</a></td>
        </tr>
    {% endfor %}
    {% endfor %}
    {% for s, files in descriptor %}
    {% for f in files %}
        <tr>
        <td>{{ f.id }}</td>
        <td>{{ f.file }}</td>
        <td>{{ s.creator }}</td>
        <td>{{ s.type }}</td>
        <td><a href="{% url 'render_file' s.id f.id %}">Html</a> <a href="{% url 'show_file' s.id f.id %}">Raw</a></td>
        </tr>
    {% endfor %}
    {% endfor %}
    {% for s, files in oracle_exec %}
    {% for f in files %}
        <tr>
        <td>{{ f.id }}</td>
        <td>{{ f.file }}</td>
        <td>{{ s.creator }}</td>
        <td>{{ s.type }}</td>
        <td><a href="{% url 'render_file' s.id f.id %}">Html</a> <a href="{% url 'show_file' s.id f.id %}">Raw</a></td>
        </tr>
    {% endfor %}
    {% endfor %}
    {% for s, files in identity %}
    {% for f in files %}
        <tr>
        <td>{{ f.id }}</td>
        <td>{{ f.file }}</td>
        <td>{{ s.creator }}</td>
        <td>{{ s.type }}</td>
        <td><a href="{% url 'render_file' s.id f.id %}">Html</a> <a href="{% url 'show_file' s.id f.id %}">Raw</a></td>
        </tr>
    {% endfor %}
    {% endfor %}
    </table>
    <p></p>
<h1>Coursework Results</h1>
    <table>
    <thead>
    <tr>
        <th>ID</th>
        <th>Test</th>
        <th>Solution</th>
        <th>Results</th>
        <th>Feedback</th>
        <th>Error Level</th>
        <th>Initiator</th>
        <th>Waiting to Run</th>
    </tr>
    </thead>
    {% for f in results %}
        <tr>
        <td>{{ f.id }}</td>
        <td>{%  if f.test %}
            <a href="{% url 'render_file' f.test.id 0 %}">View ({{ f.test.id }})</a>
        {% endif %}</td>
        <td>{%  if f.solution %}
            <a href="{% url 'render_file' f.solution.id 0 %}">View ({{ f.solution.id }})</a>
        {% endif %}</td>
        <td>{%  if f.results %}
            <a href="{% url 'show_file' f.results.id 0 %}">View ({{ f.results.id }})</a>
        {% endif %}</td>
        <td>{%  if f.feedback %}
            <a href="{% url 'show_file' f.feedback.id 0 %}">View ({{ f.feedback.id }})</a>
        {% endif %}</td>
        <td>{{ f.error_level }}</td>
        <td>{{ f.initiator }}</td>
            {% if f.waiting_to_run %}
                <td><a href="{% url 'force_test_run' f.id %}">Run Now</a></td>
            {% else %}
                <td>Has Run</td>
            {% endif %}
        </tr>
    {% endfor %}
    </table>
{% endblock %}