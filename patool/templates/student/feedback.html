{% extends 'student/base.html' %}
{% load comments %}
{% load static %}
{% block title %}Feedback{% endblock %}
{% block content %}
    <link rel="stylesheet" type="text/css" href="{% static "student/css/feedback.css" %}" />
    <script type="text/javascript" src="{% static 'student/js/feedback.js' %}" ></script>
    <div id="feedback_container">
        <div id="file_view_container">
            <div id="file_tabs">
                {% for filename in test_files %}
                    <span class="test inactive" data-id="{{ test_match.test.id }}{{ filename }}">
                        <span class="sub_name">{{ test_name }}]</span>{{ filename }}</span>
                {% endfor %}
                {% for filename in solution_files %}
                    <span class="solution inactive" data-id="{{ test_match.solution.id }}{{ filename }}">
                        <span class="sub_name">[{{ solution_name }}]</span>{{ filename }}</span>
                {% endfor %}
                {% for filename in result_files %}
                    <span class="result inactive" data-id="{{ test_match.result.id }}{{ filename }}">{{ filename }}</span>
                {% endfor %}
            </div>
            <div id="file_view">
                {% for filename in test_files %}
                    <iframe src="{% url 'download_file' test_match.test.id filename%}?pretty=1" data-id="{{ test_match.test.id }}{{ filename }}" class="test inactive"></iframe>
                {% endfor %}
                {% for filename in solution_files %}
                    <iframe src="{% url 'download_file' test_match.solution.id filename%}?pretty=1" data-id="{{ test_match.solution.id }}{{ filename }}" class="solution inactive"></iframe>
                {% endfor %}
                {% for filename in result_files %}
                    <iframe src="{% url 'download_file' test_match.result.id filename%}?pretty=1" data-id="{{ test_match.result.id }}{{ filename }}" class="result inactive"></iframe>
                {% endfor %}
                <p class="active">Select a file on the left to view it</p>
            </div>
        </div>
        <div id="feedback_input">
            {% render_comment_list for test_match %}
            {% if can_submit %}
                {% get_comment_form for test_match as form %}
                <form action="{% comment_form_target %}" method="POST">
                    {% csrf_token %}
                    {{ form.comment }}
                    {{ form.honeypot }}
                    {{ form.content_type }}
                    {{ form.object_pk }}
                    {{ form.timestamp }}
                    {{ form.security_hash }}
                    <input type="hidden" name="next" value="{% url 'feedback' test_match.id %}" />
                    <input type="submit" value="Add comment" id="id_submit" />
                </form>
            {% endif %}
        </div>
    </div>


{% endblock %}